{% extends "frontend/base.html" %}

{% load static %}

{% block title %}
Account Dashboard
{% endblock %}

{% block content %}
<div class="container mt-5">
    <h1 class="text-center text-primary mb-4">Welcome, {{ user.first_name|default:user.username }}</h1>
    <p class="text-center text-muted">Manage your resume information below.</p>

    <div class="accordion" id="resumeAccordion">
        <!-- Personal Information -->
        <div class="accordion-item">
            <h2 class="accordion-header" id="headingPersonalInfo">
                <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#personalInfo" aria-expanded="true" aria-controls="personalInfo">
                    Personal Information
                </button>
            </h2>
            <div id="personalInfo" class="accordion-collapse collapse show" aria-labelledby="headingPersonalInfo" data-bs-parent="#resumeAccordion">
                <div class="accordion-body">
                    <table class="table table-bordered table-striped">
                        <thead class="table-light">
                            <tr>
                                <th>Name</th>
                                <th>Email</th>
                                <th>Phone Number</th>
                                <th>Address</th>
                                <th>LinkedIn URL</th>
                                <th>GitHub URL</th>
                                <th>Portfolio URL</th>
                                <th>Summary</th>
                            </tr>
                        </thead>
                        <tbody id="personalInfoTableBody">
                            <tr>
                                <td>{{ user.first_name }} {{ user.last_name}}</td>
                                <td>{{ user.email }}</td>
                                <td>{{ user.user_info.phone_number }}</td>
                                <td>{{ user.user_info.address }}</td>
                                <td>{{ user.user_info.linkedin_url }}</td>
                                <td>{{ user.user_info.github_url }}</td>
                                <td>{{ user.user_info.portfolio_url }}</td>
                                <td>{{ user.user_info.summary }}</td>
                            </tr>
                        </tbody>
                    </table>
                    <button class="btn btn-success btn-sm mt-2" onclick="getPage('/templates/frontend/modals/user_info_modal', popup);">Edit</button>
                </div>
            </div>
        </div>

        <!-- Education -->
        <div class="accordion-item">
            <h2 class="accordion-header" id="headingEducation">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#education" aria-expanded="false" aria-controls="education">
                    Education
                </button>
            </h2>
            <div id="education" class="accordion-collapse collapse" aria-labelledby="headingEducation" data-bs-parent="#resumeAccordion">
                <div class="accordion-body">
                    <table class="table table-bordered table-striped">
                        <thead class="table-light">
                            <tr>
                                <th>School Name</th>
                                <th>Degree</th>
                                <th>Graduation Year</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="educationTableBody">
                            {% for education in user.educations.all %}
                            <tr>
                                <td>{{ education.school_name }}</td>
                                <td>{{ education.degree }}</td>
                                <td>{{ education.graduation_year }}</td>
                                <td>
                                    <button class="btn btn-sm btn-primary edit-education" onclick="getPage('/templates/frontend/modals/education_modal?id={{ education.id }}', popup);">Edit</button>
                                    <button class="btn btn-sm btn-danger delete-education" data-id="{{ education.id }}">Delete</button>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                    <button class="btn btn-success btn-sm mt-2" id="addEducation" onclick="getPage('/templates/frontend/modals/education_modal', popup);">Add New</button>
                </div>
            </div>
        </div>

        <!-- Work Experience -->
        <div class="accordion-item">
            <h2 class="accordion-header" id="headingWorkExperience">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#workExperience" aria-expanded="false" aria-controls="workExperience">
                    Work Experience
                </button>
            </h2>
            <div id="workExperience" class="accordion-collapse collapse" aria-labelledby="headingWorkExperience" data-bs-parent="#resumeAccordion">
                <div class="accordion-body">
                    <table class="table table-bordered table-striped">
                        <thead class="table-light">
                            <tr>
                                <th>Job Title</th>
                                <th>Company Name</th>
                                <th>Description</th>
                                <th>Start Date</th>
                                <th>End Date</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="workExperienceTableBody">
                            {% for experience in user.work_experiences.all %}
                            <tr>
                                <td>{{ experience.job_title }}</td>
                                <td>{{ experience.company_name }}</td>
                                <td>{{ experience.job_description }}</td>
                                <td>{{ experience.start_date }}</td>
                                <td>{{ experience.end_date }}</td>
                                <td>
                                    <button class="btn btn-sm btn-primary edit-work-experience" data-id="{{ experience.id }}">Edit</button>
                                    <button class="btn btn-sm btn-danger delete-work-experience" data-id="{{ experience.id }}">Delete</button>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                    <button class="btn btn-success btn-sm mt-2" id="addWorkExperience" onclick="getPage('/templates/frontend/modals/work_experience_modal', popup);">Add New</button>
                </div>
            </div>
        </div>

        <!-- Add Skills, Projects, and Certifications as above -->
        <!-- Example for Skills -->
        <div class="accordion-item">
            <h2 class="accordion-header" id="headingSkills">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#skills" aria-expanded="false" aria-controls="skills">
                    Skills
                </button>
            </h2>
            <div id="skills" class="accordion-collapse collapse" aria-labelledby="headingSkills" data-bs-parent="#resumeAccordion">
                <div class="accordion-body">
                    <table class="table table-bordered table-striped">
                        <thead class="table-light">
                            <tr>
                                <th>Skill</th>
                                <th>Years of Experience</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="skillsTableBody">
                            {% for skill in user.skills.all %}
                            <tr>
                                <td>{{ skill.skill_name }}</td>
                                <td>{{ skill.years_of_experience }}</td>
                                <td>
                                    <button class="btn btn-sm btn-primary edit-skill" data-id="{{ skill.id }}">Edit</button>
                                    <button class="btn btn-sm btn-danger delete-skill" data-id="{{ skill.id }}">Delete</button>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                    <button class="btn btn-success btn-sm mt-2" id="addSkill" onclick="getPage('/templates/frontend/modals/skill_modal', popup);">Add New</button>
                </div>
            </div>
        </div>

        <!-- Projects -->
        <div class="accordion-item">
            <h2 class="accordion-header" id="headingProjects">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#projects" aria-expanded="false" aria-controls="projects">
                    Projects
                </button>
            </h2>
            <div id="projects" class="accordion-collapse collapse" aria-labelledby="headingProjects" data-bs-parent="#resumeAccordion">
                <div class="accordion-body">
                    <table class="table table-bordered table-striped">
                        <thead class="table-light">
                            <tr>
                                <th>Project Title</th>
                                <th>Description</th>
                                <th>Technologies Used</th>
                                <th>Project URL</th>
                                <th>Start Date</th>
                                <th>End Date</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="projectsTableBody">
                            {% for project in user.projects.all %}
                            <tr>
                                <td>{{ project.project_title }}</td>
                                <td>{{ project.description }}</td>
                                <td>{{ project.technologies_used }}</td>
                                <td>{{ project.project_url }}</td>
                                <td>{{ project.start_date }}</td>
                                <td>{{ project.end_date }}</td>
                                <td>
                                    <button class="btn btn-sm btn-primary edit-project" data-id="{{ project.id }}">Edit</button>
                                    <button class="btn btn-sm btn-danger delete-project" data-id="{{ project.id }}">Delete</button>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                    <button class="btn btn-success btn-sm mt-2" id="addProject" onclick="getPage('/templates/frontend/modals/project_modal', popup);">Add New</button>
                </div>
            </div>
        </div>

        <!-- Certifications -->
        <div class="accordion-item">
            <h2 class="accordion-header" id="headingCertifications">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#certifications" aria-expanded="false" aria-controls="certifications">
                    Certifications
                </button>
            </h2>
            <div id="certifications" class="accordion-collapse collapse" aria-labelledby="headingCertifications" data-bs-parent="#resumeAccordion">
                <div class="accordion-body">
                    <table class="table table-bordered table-striped">
                        <thead class="table-light">
                            <tr>
                                <th>Certification Name</th>
                                <th>Issuing Organization</th>
                                <th>Issue Date</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="certificationsTableBody">
                            {% for certification in user.certifications.all %}
                            <tr>
                                <td>{{ certification.certification_name }}</td>
                                <td>{{ certification.issuing_organization }}</td>
                                <td>{{ certification.issue_date }}</td>
                                <td>{{ certification.expiration_date }}</td>
                                <td>{{ certification.credential_id }}</td>
                                <td>{{ certification.credential_url }}</td>
                                <td>
                                    <button class="btn btn-sm btn-primary edit-certification" data-id="{{ certification.id }}">Edit</button>
                                    <button class="btn btn-sm btn-danger delete-certification" data-id="{{ certification.id }}">Delete</button>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                    <button class="btn btn-success btn-sm mt-2" id="addCertification" onclick="getPage('/templates/frontend/modals/certification_modal', popup);">Add New</button>
                </div>
            </div>
        </div>


    </div>
</div>

<!-- Chat Bubble -->
{% include "frontend/chat-bubble.html" %}

{% endblock %}

{% block scripts %}
<script src="{% static 'js/dashboard.js' %}"></script>
{% endblock %}


